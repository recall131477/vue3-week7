"use strict";(self["webpackChunkvue3_week7"]=self["webpackChunkvue3_week7"]||[]).push([[444],{2444:function(t,o,e){e.r(o),e.d(o,{default:function(){return pt}});var s=e(6252),n=e(3577),i=e(9963);const a={class:"container"},l={class:"mt-4"},d=(0,s._)("h2",{class:"text-center"},"購物車",-1),u={class:"text-end"},c=["disabled"],r=(0,s.Uk)("繼續購物"),p=(0,s.Uk)(" 前往結帳 "),h={key:0,class:"text-center"},g=(0,s._)("p",null,"購物車目前沒有商品",-1),m=(0,s.Uk)("前往購物"),C={key:1,class:"table align-middle"},_=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{style:{width:"25%"}}),(0,s._)("th",{style:{width:"25%"}},"品名"),(0,s._)("th",{style:{width:"10%"}},"數量/單位"),(0,s._)("th",{style:{width:"25%"},class:"text-end"},"單價")])],-1),b=["onClick","disabled"],f={key:0,class:"fas fa-spinner fa-pulse"},w=(0,s.Uk)(" x "),x={class:"input-group input-group-sm"},v={class:"input-group mb-3"},k=["onUpdate:modelValue","onChange","disabled"],y=["value"],$={class:"input-group-text",id:"basic-addon2"},M={class:"text-end"},z=(0,s._)("td",{colspan:"3",class:"text-end"},"總計",-1),I={class:"text-end"},D={key:0},L=(0,s._)("td",{colspan:"3",class:"text-end"},"折扣後金額",-1),W={class:"text-end"},q={class:"d-flex justify-content-end align-items-center"},S=(0,s._)("label",{for:"coupon"},"優惠券",-1),U=["disabled"],A=["disabled"];function H(t,o,e,H,O,Y){const K=(0,s.up)("VLoading"),P=(0,s.up)("router-link"),V=(0,s.up)("FrontCouponModal");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",a,[(0,s._)("div",l,[(0,s.Wm)(K,{active:O.isLoading},null,8,["active"]),d,(0,s._)("div",u,[(0,s._)("button",{class:(0,n.C_)(["btn btn-outline-danger",{"not-pointer":0===O.cart.carts.length}]),type:"button",onClick:o[0]||(o[0]=(...t)=>Y.deleteAllCarts&&Y.deleteAllCarts(...t)),disabled:0===O.cart.carts.length}," 清空購物車 ",10,c),0!==O.cart.carts.length?((0,s.wg)(),(0,s.j4)(P,{key:0,to:"/products",class:"btn btn-primary mx-3"},{default:(0,s.w5)((()=>[r])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(P,{to:"/checkout",class:(0,n.C_)(["btn btn-primary",{"not-pointer disabled":0===O.cart.carts.length}])},{default:(0,s.w5)((()=>[p])),_:1},8,["class"])]),0===O.cart.carts.length?((0,s.wg)(),(0,s.iD)("div",h,[g,(0,s.Wm)(P,{to:"/products",class:"btn btn-outline-danger"},{default:(0,s.w5)((()=>[m])),_:1})])):((0,s.wg)(),(0,s.iD)("table",C,[_,(0,s._)("tbody",null,[O.cart.carts?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(O.cart.carts,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>Y.deleteCartItem(t.id),disabled:O.isLoadingItem===t.id},[O.isLoadingItem===t.id?((0,s.wg)(),(0,s.iD)("i",f)):(0,s.kq)("",!0),w],8,b)]),(0,s._)("td",null,(0,n.zw)(t.product.title),1),(0,s._)("td",null,[(0,s._)("div",x,[(0,s._)("div",v,[(0,s.wy)((0,s._)("select",{id:"",class:"form-select","onUpdate:modelValue":o=>t.qty=o,onChange:o=>Y.updateCartItem(t),disabled:O.isLoadingItem===t.id},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(o=>(0,s._)("option",{value:o,key:`${o}-${t.id}`},(0,n.zw)(o),9,y))),64))],40,k),[[i.bM,t.qty]]),(0,s._)("span",$,(0,n.zw)(t.product.unit),1)])])]),(0,s._)("td",M,(0,n.zw)(t.total),1)])))),128)):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[z,(0,s._)("td",I,(0,n.zw)(O.cart.total),1)]),O.isCoupon?((0,s.wg)(),(0,s.iD)("tr",D,[L,(0,s._)("td",W,(0,n.zw)(O.cart.final_total),1)])):(0,s.kq)("",!0)])])),(0,s._)("div",q,[(0,s._)("div",null,[S,(0,s.wy)((0,s._)("input",{type:"text",id:"coupon",disabled:O.isCoupon,"onUpdate:modelValue":o[1]||(o[1]=t=>O.couponCode=t)},null,8,U),[[i.nr,O.couponCode]])]),O.isCoupon?((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",class:"btn btn-success",disabled:O.isCoupon}," 已套用優惠券 ",8,A)):((0,s.wg)(),(0,s.iD)("button",{key:1,type:"button",class:"btn btn-success",onClick:o[2]||(o[2]=(...t)=>Y.openModal&&Y.openModal(...t))},"領取優惠券"))])])]),(0,s.Wm)(V,{ref:"frontCouponModal",onGetCoupon:Y.useCoupon},null,8,["onGetCoupon"])],64)}var O=e(4902);const Y={class:"modal fade",ref:"frontCouponModal"},K={class:"modal-dialog"},P={class:"modal-content"},V={class:"coupon-puzzle"},Z={class:"wait"},j=["onClick"],F=["src"],G={class:"carried"},E=["onClick"],B=["src"];function J(t,o,e,n,i,a){return(0,s.wg)(),(0,s.iD)("div",Y,[(0,s._)("div",K,[(0,s._)("div",P,[(0,s._)("div",V,[(0,s._)("div",Z,[(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.todoWait,((t,o)=>((0,s.wg)(),(0,s.iD)("li",{key:t.url,onClick:e=>a.handPuzzle(t,o)},[(0,s._)("img",{src:t.url,alt:""},null,8,F)],8,j)))),128))])]),(0,s._)("div",G,[(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.todoOver,((t,o)=>((0,s.wg)(),(0,s.iD)("li",{key:t.url,onClick:e=>a.resetPuzzle(t,o)},[(0,s._)("img",{src:t.url,alt:""},null,8,B)],8,E)))),128))])])])])])],512)}var N=e(7424),Q=e.n(N),R=e(650),T=e(5789),X=e(4734),tt=e(557),ot=e(9679),et=e(6977),st=e(7545),nt=e(7765),it=e(3476),at={data(){return{couponModal:"",todoWait:[{idx:8,url:it},{idx:1,url:T},{idx:6,url:st},{idx:5,url:et},{idx:7,url:nt},{idx:0,url:R},{idx:3,url:tt},{idx:2,url:X},{idx:4,url:ot}],todoOver:[],winIdx:0,isWin:!1}},watch:{todoOver:{handler(t){this.winIdx=0,t.forEach(((t,o)=>{t.idx===o&&(this.winIdx+=1)}))},deep:!0},winIdx(t){9===t&&(this.isWin=!0,this.closeCouponModal(),this.$emit("get-coupon"))}},methods:{randomArr(){this.todoWait.sort((()=>Math.random()>.5?-1:1))},handPuzzle(t,o){this.todoOver.push(t),this.todoWait.splice(o,1)},resetPuzzle(t,o){this.todoWait.push(t),this.todoOver.splice(o,1)},openCouponModal(){this.couponModal.show()},closeCouponModal(){this.couponModal.hide()}},mounted(){this.randomArr(),this.couponModal=new(Q())(this.$refs.frontCouponModal)}},lt=e(3744);const dt=(0,lt.Z)(at,[["render",J]]);var ut=dt,ct={data(){return{cart:{carts:[]},couponCode:"",isLoadingItem:"",isLoading:!1,isCoupon:!1,status:""}},components:{FrontCouponModal:ut},methods:{getCart(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/v2/api/rousong/cart";this.$http.get(t).then((t=>{this.cart=t.data.data,this.cart.final_total!==this.cart.total?(this.isCoupon=!0,this.couponCode="double777"):this.isCoupon=!1,this.isLoading=!1})).catch((t=>{this.$messageState(t.response,"錯誤訊息")}))},updateCartItem(t){const o={product_id:t.id,qty:t.qty},e=`https://vue3-course-api.hexschool.io/v2/api/rousong/cart/${t.id}`,s="更新商品";this.isLoadingItem=t.id,this.$http.put(e,{data:o}).then((t=>{this.$messageState(t,s),this.getCart(),this.isLoadingItem=""})).catch((t=>{this.$messageState(t.response,"錯誤訊息")}))},deleteCartItem(t){const o=`https://vue3-course-api.hexschool.io/v2/api/rousong/cart/${t}`,e="刪除商品";this.isLoadingItem=t,this.$http.delete(o).then((t=>{this.$messageState(t,e),O.Z.emit("get-cart"),this.getCart(),this.isLoadingItem=""})).catch((t=>{this.$messageState(t.response,"錯誤訊息")}))},deleteAllCarts(){const t="https://vue3-course-api.hexschool.io/v2/api/rousong/carts",o="刪除全部商品";this.$http.delete(t).then((t=>{this.$messageState(t,o),O.Z.emit("get-cart"),this.getCart()})).catch((t=>{this.$messageState(t.response,"錯誤訊息")}))},useCoupon(){this.couponCode="double777",this.isCoupon=!0;const t="https://vue3-course-api.hexschool.io/v2/api/rousong/coupon",o={code:this.couponCode};this.$http.post(t,{data:o}).then((t=>{t.data.success&&(console.log(t),this.cart.final_total=t.data.data.final_total,this.isCoupon=!0)})).catch((t=>{this.$messageState(t.response,"錯誤訊息")}))},openModal(){this.$refs.frontCouponModal.openCouponModal()}},mounted(){this.getCart()}};const rt=(0,lt.Z)(ct,[["render",H]]);var pt=rt},650:function(t,o,e){t.exports=e.p+"img/1.48a4b4a4.png"},5789:function(t,o,e){t.exports=e.p+"img/2.bcb15c58.png"},4734:function(t,o,e){t.exports=e.p+"img/3.3a2aaa8a.png"},557:function(t,o,e){t.exports=e.p+"img/4.c8ebc21a.png"},9679:function(t,o,e){t.exports=e.p+"img/5.219a00d0.png"},6977:function(t,o,e){t.exports=e.p+"img/6.94c685e9.png"},7545:function(t,o,e){t.exports=e.p+"img/7.04091053.png"},7765:function(t,o,e){t.exports=e.p+"img/8.83146947.png"},3476:function(t,o,e){t.exports=e.p+"img/9.39b7fbaf.png"}}]);
//# sourceMappingURL=444.999b1c4d.js.map