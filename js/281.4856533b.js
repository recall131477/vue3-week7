"use strict";(self["webpackChunkvue3_week7"]=self["webpackChunkvue3_week7"]||[]).push([[281],{3123:function(e,t,a){a.d(t,{Z:function(){return y}});var l=a(6252),r=a(3577),d=a(9963);const s={"aria-label":"Page navigation example"},n={class:"pagination justify-content-center"},i=(0,l._)("span",{"aria-hidden":"true"},"第一頁",-1),o=[i],u=(0,l._)("span",{"aria-hidden":"true"},"上一頁",-1),p=[u],c=["onClick"],_=(0,l._)("span",{"aria-hidden":"true"},"下一頁",-1),h=[_],g=(0,l._)("span",{"aria-hidden":"true"},"最後一頁",-1),m=[g];function b(e,t,a,i,u,_){return(0,l.wg)(),(0,l.iD)("nav",s,[(0,l._)("ul",n,[(0,l._)("li",{class:(0,r.C_)(["page-item",{"d-none":!a.pages.has_pre}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,d.iM)((e=>_.changePages(a.pages.current_page-(a.pages.total_pages-1))),["prevent"]))},o)],2),(0,l._)("li",{class:(0,r.C_)(["page-item",{"d-none":!a.pages.has_pre}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[1]||(t[1]=(0,d.iM)((e=>_.changePages(a.pages.current_page-1)),["prevent"]))},p)],2),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.total_pages,((e,t)=>((0,l.wg)(),(0,l.iD)("li",{class:(0,r.C_)(["page-item",{active:e===a.pages.current_page}]),key:t},[(0,l._)("a",{class:"page-link",href:"#",onClick:(0,d.iM)((t=>_.changePages(e)),["prevent"])},(0,r.zw)(e),9,c)],2)))),128)),(0,l._)("li",{class:(0,r.C_)(["page-item",{"d-none":!a.pages.has_next}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[2]||(t[2]=(0,d.iM)((e=>_.changePages(a.pages.current_page+1)),["prevent"]))},h)],2),(0,l._)("li",{class:(0,r.C_)(["page-item",{"d-none":!a.pages.has_next}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[3]||(t[3]=(0,d.iM)((e=>_.changePages(a.pages.current_page+(a.pages.total_pages-1))),["prevent"]))},m)],2)])])}var O={props:{pages:{type:Object,default(){return{}}}},methods:{changePages(e){this.$emit("change-pages",e)}}},w=a(3744);const f=(0,w.Z)(O,[["render",b]]);var y=f},5281:function(e,t,a){a.r(t),a.d(t,{default:function(){return Pe}});var l=a(6252),r=a(3577),d=a(9963);const s={class:"mt-4"},n=(0,l._)("h2",{class:"text-center"},"訂單頁面",-1),i={class:"table mt-4"},o=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"購買時間"),(0,l._)("th",null,"Email"),(0,l._)("th",null,"購買款項"),(0,l._)("th",null,"應付金額"),(0,l._)("th",null,"是否付款"),(0,l._)("th",null,"編輯")])],-1),u=["textContent"],p={class:"list-unstyled"},c={class:"text-right"},_={class:"form-check form-switch"},h=["id","onUpdate:modelValue","onChange"],g=["for"],m={key:0},b={key:1},O={class:"btn-group"},w=["onClick"],f=["onClick"];function y(e,t,a,y,k,v){const M=(0,l.up)("VLoading"),D=(0,l.up)("Pagination"),x=(0,l.up)("OrderModal"),C=(0,l.up)("DelOrderModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(M,{active:k.isLoading},null,8,["active"]),(0,l._)("div",s,[n,(0,l._)("table",i,[o,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(k.orders,((t,a)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:a},[k.orders.length?((0,l.wg)(),(0,l.iD)("tr",{key:0,class:(0,r.C_)({"text-secondary":!t.is_paid})},[(0,l._)("td",null,(0,r.zw)(e.$filters.date(t.create_at)),1),(0,l._)("td",null,[t.user?((0,l.wg)(),(0,l.iD)("span",{key:0,textContent:(0,r.zw)(t.user.email)},null,8,u)):(0,l.kq)("",!0)]),(0,l._)("td",null,[(0,l._)("ul",p,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.products,((e,t)=>((0,l.wg)(),(0,l.iD)("li",{key:t},(0,r.zw)(e.product.title)+" 數量："+(0,r.zw)(e.qty)+" "+(0,r.zw)(e.product.unit),1)))),128))])]),(0,l._)("td",c,(0,r.zw)(t.total),1),(0,l._)("td",null,[(0,l._)("div",_,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,onChange:e=>v.updatePaid(t)},null,40,h),[[d.e8,t.is_paid]]),(0,l._)("label",{class:"form-check-label",for:`paidSwitch${t.id}`},[t.is_paid?((0,l.wg)(),(0,l.iD)("span",m,"已付款")):((0,l.wg)(),(0,l.iD)("span",b,"未付款"))],8,g)])]),(0,l._)("td",null,[(0,l._)("div",O,[(0,l._)("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:e=>v.openModal("edit",t)}," 檢視 ",8,w),(0,l._)("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:e=>v.openModal("delete",t)}," 刪除 ",8,f)])])],2)):(0,l.kq)("",!0)],64)))),128))])])]),(0,l.Wm)(D,{pages:k.pagination,onChangePages:v.getOrders},null,8,["pages","onChangePages"]),(0,l.Wm)(x,{ref:"orderModal",order:k.tempOrder,currentPage:k.pagination.current_page,onUpdatePaid:v.updatePaid},null,8,["order","currentPage","onUpdatePaid"]),(0,l.Wm)(C,{ref:"deleteOrderModal",delOrder:k.tempOrder,onUpdateOrder:v.getOrders},null,8,["delOrder","onUpdateOrder"])],64)}const k={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"orderModal"},v={class:"modal-dialog modal-xl",role:"document"},M={class:"modal-content border-0"},D=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l._)("span",null,"訂單細節")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),x={class:"modal-body"},C={class:"row"},$={class:"col-md-4"},P=(0,l._)("h3",null,"用戶資料",-1),z={class:"table"},S={key:0},L=(0,l._)("th",{style:{width:"100px"}},"姓名",-1),U=(0,l._)("th",null,"Email",-1),N=(0,l._)("th",null,"電話",-1),H=(0,l._)("th",null,"地址",-1),J={class:"col-md-8"},Y=(0,l._)("h3",null,"訂單細節",-1),Z={class:"table"},j=(0,l._)("th",{style:{width:"100px"}},"訂單編號",-1),q=(0,l._)("th",null,"下單時間",-1),K=(0,l._)("th",null,"付款時間",-1),V={key:0},W={key:1},E=(0,l._)("th",null,"付款狀態",-1),A={key:0,class:"text-success"},B={key:1,class:"text-muted"},F=(0,l._)("th",null,"總金額",-1),G=(0,l._)("h3",null,"選購商品",-1),I={class:"table"},Q=(0,l._)("thead",null,[(0,l._)("tr")],-1),R={class:"text-end"},T={class:"d-flex justify-content-end"},X={class:"form-check"},ee={class:"form-check-label",for:"flexCheckDefault"},te={key:0},ae={key:1},le={class:"modal-footer"},re=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function de(e,t,a,s,n,i){return(0,l.wg)(),(0,l.iD)("div",k,[(0,l._)("div",v,[(0,l._)("div",M,[D,(0,l._)("div",x,[(0,l._)("div",C,[(0,l._)("div",$,[P,(0,l._)("table",z,[n.tempOrder.user?((0,l.wg)(),(0,l.iD)("tbody",S,[(0,l._)("tr",null,[L,(0,l._)("td",null,(0,r.zw)(n.tempOrder.user.name),1)]),(0,l._)("tr",null,[U,(0,l._)("td",null,(0,r.zw)(n.tempOrder.user.email),1)]),(0,l._)("tr",null,[N,(0,l._)("td",null,(0,r.zw)(n.tempOrder.user.tel),1)]),(0,l._)("tr",null,[H,(0,l._)("td",null,(0,r.zw)(n.tempOrder.user.address),1)])])):(0,l.kq)("",!0)])]),(0,l._)("div",J,[Y,(0,l._)("table",Z,[(0,l._)("tbody",null,[(0,l._)("tr",null,[j,(0,l._)("td",null,(0,r.zw)(n.tempOrder.id),1)]),(0,l._)("tr",null,[q,(0,l._)("td",null,(0,r.zw)(e.$filters.date(n.tempOrder.create_at)),1)]),(0,l._)("tr",null,[K,(0,l._)("td",null,[n.tempOrder.paid_date?((0,l.wg)(),(0,l.iD)("span",V,(0,r.zw)(e.$filters.date(n.tempOrder.paid_date)),1)):((0,l.wg)(),(0,l.iD)("span",W,"時間不正確"))])]),(0,l._)("tr",null,[E,(0,l._)("td",null,[n.tempOrder.is_paid?((0,l.wg)(),(0,l.iD)("strong",A,"已付款")):((0,l.wg)(),(0,l.iD)("span",B,"尚未付款"))])]),(0,l._)("tr",null,[F,(0,l._)("td",null,(0,r.zw)(e.$filters.currency(n.tempOrder.total)),1)])])]),G,(0,l._)("table",I,[Q,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.tempOrder.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("th",null,(0,r.zw)(t.product.title),1),(0,l._)("td",null,(0,r.zw)(t.qty)+" / "+(0,r.zw)(t.product.unit),1),(0,l._)("td",R,(0,r.zw)(e.$filters.currency(t.final_total)),1)])))),128))])]),(0,l._)("div",T,[(0,l._)("div",X,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":t[0]||(t[0]=e=>n.tempOrder.is_paid=e)},null,512),[[d.e8,n.tempOrder.is_paid]]),(0,l._)("label",ee,[n.tempOrder.is_paid?((0,l.wg)(),(0,l.iD)("span",te,"已付款")):((0,l.wg)(),(0,l.iD)("span",ae,"未付款"))])])])])])]),(0,l._)("div",le,[re,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>i.updatePaid&&i.updatePaid(...e))},"修改付款狀態")])])])],512)}var se=a(7424),ne=a.n(se),ie={props:{order:{type:Object,default(){return{}}}},data(){return{tempOrder:{},orderModal:""}},watch:{order(){this.tempOrder=JSON.parse(JSON.stringify(this.order))}},methods:{updatePaid(){this.$emit("update-paid",this.tempOrder)},openOrderModal(){this.orderModal.show()},closeOrderModal(){this.orderModal.hide()}},mounted(){this.orderModal=new(ne())(this.$refs.orderModal)}},oe=a(3744);const ue=(0,oe.Z)(ie,[["render",de]]);var pe=ue;const ce={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},_e={class:"modal-dialog"},he={class:"modal-content border-0"},ge=(0,l._)("div",{class:"modal-header bg-danger text-white"},[(0,l._)("h5",{id:"delOrderModalLabel",class:"modal-title"},[(0,l._)("span",null,"刪除")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),me={class:"modal-body"},be=(0,l.Uk)(" 是否刪除 "),Oe={class:"text-danger"},we=(0,l.Uk)(" 商品(刪除後將無法恢復)。 "),fe={class:"modal-footer"},ye=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ke(e,t,a,d,s,n){return(0,l.wg)(),(0,l.iD)("div",ce,[(0,l._)("div",_e,[(0,l._)("div",he,[ge,(0,l._)("div",me,[be,(0,l._)("strong",Oe,(0,r.zw)(a.delOrder.title),1),we]),(0,l._)("div",fe,[ye,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...e)=>n.deleteOrder&&n.deleteOrder(...e))},"確認刪除")])])])],512)}var ve={props:{delOrder:{type:Object,default(){return{}}}},data(){return{delOrderModal:""}},methods:{deleteOrder(){const e="刪除商品",{id:t}=this.delOrder,a=`https://vue3-course-api.hexschool.io/v2/api/rousong/admin/order/${t}`;this.$http.delete(a).then((t=>{this.$messageState(t,e),this.$emit("update-order"),this.closeDeleteOrderModal()})).catch((e=>{this.$messageState(e.response,"錯誤訊息")}))},openDeleteOrderModal(){this.delOrderModal.show()},closeDeleteOrderModal(){this.delOrderModal.hide()}},mounted(){this.delOrderModal=new(ne())(this.$refs.delOrderModal)}};const Me=(0,oe.Z)(ve,[["render",ke]]);var De=Me,xe=a(3123),Ce={data(){return{orders:{},status:"",pagination:{},tempOrder:{},isLoading:!1}},components:{OrderModal:pe,DelOrderModal:De,Pagination:xe.Z},methods:{getOrders(e=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/v2/api/rousong/admin/orders?page=${e}`;this.$http.get(t,this.tempProduct).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1})).catch((e=>{this.$messageState(e.response,"錯誤訊息")}))},updatePaid(e){const t=`https://vue3-course-api.hexschool.io/v2/api/rousong/admin/order/${e.id}`,a={is_paid:e.is_paid},l="更新付款狀態";this.$http.put(t,{data:a}).then((e=>{this.$messageState(e,l),this.getOrders(),this.$refs.orderModal.closeOrderModal()})).catch((e=>{this.$messageState(e.response,"錯誤訊息")}))},openModal(e,t){this.status=e,"edit"===e?(this.tempOrder=JSON.parse(JSON.stringify(t)),this.$refs.orderModal.openOrderModal()):"delete"===e&&(this.tempOrder=JSON.parse(JSON.stringify(t)),this.$refs.deleteOrderModal.openDeleteOrderModal())}},mounted(){this.getOrders()}};const $e=(0,oe.Z)(Ce,[["render",y]]);var Pe=$e}}]);
//# sourceMappingURL=281.4856533b.js.map